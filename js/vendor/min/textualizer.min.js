!function(e,t){"use strict";function n(e){var n,o,r,i,s,a={};if(t.getComputedStyle)if(n=t.getComputedStyle(e,null),n.length)for(i=0,s=n.length;s>i;i++)r=n[i].replace(/\-([a-z])/,function(e,t){return t.toUpperCase()}),a[r]=n.getPropertyValue(n[i]);else for(o in n)"function"!=typeof n[o]&&"length"!==o&&(a[o]=n[o]);else{n=e.currentStyle||e.style;for(o in n)Object.prototype.hasOwnProperty.call(n,o)&&(a[o]=n[o])}return a}function o(){this.character=null,this.domNode=null,this.pos=null,this.used=!1,this.inserted=!1,this.visited=!1}function r(){this.str="",this.characterList=[]}var i,s=100,a=100,u=300,d=1e3,c=1e3,f="textualizer.changed";r.prototype={use:function(t){var n=null;return e.each(this.characterList,function(){return this.character!==t||this.used?void 0:(this.used=!0,n=this,!1)}),n},reset:function(){e.each(this.characterList,function(){this.inserted=!1,this.used=!1})}},i=function(i,u,p){function l(t,n){var o=p.centered?(b-j.height())/2:0;e.each(n,function(e,n){n.pos=n.domNode.position(),n.domNode=n.domNode.clone(),n.pos.top+=o,n.domNode.css({left:n.pos.left,top:n.pos.top,position:"absolute"}),t.characterList.push(n)}),j.html("")}function h(t){var n,i,s,a,u=[],d=new r;for(d.str=O[t],D.push(d),n=0,a=d.str.length;a>n;n++)i=d.str.charAt(n),""===i?j.append(" "):(s=new o,s.character=i,s.domNode=e("<span/>").text(i),j.append(s.domNode),u.push(s));return l(d,u),d}function m(){var t,n;return n=[function(n){return t=e.Deferred(),n.animate({top:L.bottom,opacity:"hide"},t.resolve),t.promise()},function(n){return t=e.Deferred(),n.fadeOut(1e3,t.resolve),t.promise()}],n[Math.floor(Math.random()*n.length)]}function v(t,n){var o,r=[],i=[],s=e.Deferred(),a=m();return e.each(t.characterList,function(t,s){o=n.use(s.character),o?(o.domNode=s.domNode,o.inserted=!0,r.push(o)):!function(e){i.push(e),a(s.domNode.delay(Math.random()*c)).done(function(){s.domNode.remove(),e.resolve()})}(e.Deferred())}),e.when.apply(null,i).done(function(){return s.resolve(r)}),s.promise()}function y(n){var o=e.fn.textualizer.effects,r="random"===p.effect?o[Math.floor(Math.random()*(o.length-2))+1][1]:S,i=e.Deferred(),s=[];return e.each(n.characterList,function(n,o){o.inserted||(o.domNode.css({left:o.pos.left,top:o.pos.top}),function(e){t.setTimeout(function(){r({item:o,container:A,dfd:e})},Math.random()*d),s.push(e)}(e.Deferred()))}),e.when.apply(null,s).done(function(){i.resolve()}),i.promise()}function g(n,o){var r=e.Deferred(),i=[];return t.setTimeout(function(){e.each(n,function(t,n){!function(e){n.domNode.animate({left:n.pos.left,top:n.pos.top},p.rearrangeDuration,e.resolve),i.push(e.promise())}(e.Deferred())}),e.when.apply(null,i).done(function(){t.setTimeout(function(){y(o).done(function(){r.resolve()})},a)})},s),r.promise()}function N(){z===O.length-1&&(e.each(D,function(e,t){t.reset()}),z=-1,p.loop||C.pause()),z++,w(z)}function x(t){var n=e.Deferred(),o=D[t];return o||(o=h(t)),T?v(T,o).done(function(e){g(e,o).done(function(){n.resolve()})}):y(o).done(function(){n.resolve()}),T=o,n.promise()}function w(e){P||x(e).done(function(){i.trigger(f,{index:e}),t.setTimeout(N,p.duration)})}var D,z,T,b,L,M,A,j,C=this,O=[],S=null,I=!1,P=!1;"random"!==p.effect&&e.each(e.fn.textualizer.effects,function(){return this[0]===p.effect?(S=this[1],!1):void 0}),M=i.clone().removeAttr("id").appendTo(t.document.body),M.css(n(i[0])),M.css({position:"absolute",top:"-1000px"}),j=e("<div />").css({position:"relative",visibility:"hidden"}).appendTo(M),i.css("overflow","hidden"),A=e("<div />").css("position","relative").appendTo(i),b=i.height(),L={bottom:b},this.data=function(e){this.stop(),O=e,D=[]},this.stop=function(){this.pause(),I=!1,T=null,z=0,A.empty(),j.empty()},this.pause=function(){P=!0,I=!1},this.start=function(){0===O.length||I||(z=z||0,I=!0,P=!1,w(z))},this.destroy=function(){A.parent().removeData("textualizer").end().remove(),j.remove()},u&&u instanceof Array&&this.data(u)},e.fn.textualizer=function(){var t,n,o,r,s=arguments;return r=function(r){return o=r.data("textualizer"),o||(t=[],1===s.length&&s[0]instanceof Array?t=s[0]:1===s.length&&"object"==typeof s[0]?n=s[0]:2===s.length&&(t=s[0],n=s[1]),0===t.length&&r.find("p").each(function(){t.push(e(this).text())}),r.html(""),o=new i(r,t,e.extend({},e.fn.textualizer.defaults,n)),r.data("textualizer",o)),o}(this),"string"==typeof s[0]&&r[s[0]]&&r[s[0]].apply(r,Array.prototype.slice.call(s,1)),this},e.fn.textualizer.defaults={effect:"random",duration:2e3,rearrangeDuration:1e3,centered:!1,loop:!0},e.fn.textualizer.effects=[["none",function(e){e.container.append(e.item.domNode.show())}],["fadeIn",function(e){return e.container.append(e.item.domNode.fadeIn(u,e.dfd.resolve)),e.dfd.promise()}],["slideLeft",function(e){return e.item.domNode.appendTo(e.container).css({left:-1e3}).show().animate({left:e.item.pos.left},u,e.dfd.resolve),e.dfd.promise()}],["slideTop",function(e){return e.item.domNode.appendTo(e.container).css({top:-1e3}).show().animate({top:e.item.pos.top},u,e.dfd.resolve),e.dfd.promise()}]]}(jQuery,window);